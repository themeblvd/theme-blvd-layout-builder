jQuery(document).ready(function(b){var f=false;var g={nag:function(){if(f){return false}var l=b("body").hasClass("toplevel_page_themeblvd_builder")?true:false,k=l?themeblvd.nag_save_template:themeblvd.nag_save,j='<div id="tb-builder-notice" class="notice notice-warning is-dismissible" style="display:none"> 						<p> '+k+'</p> 						<button type="button" class="notice-dismiss"><span class="screen-reader-text">'+themeblvd.dismiss+"</span></button> 						</div>";if(l){a.find(".nav-tab-wrapper").after(j).closest("#wpbody-content").find("#tb-builder-notice").fadeIn(500)}else{b("#lost-connection-notice").before(j).closest("#wpbody-content").find("#tb-builder-notice").fadeIn(500)}f=true},edit:function(j){j.themeblvd("options","setup");j.themeblvd("options","media-uploader");j.themeblvd("options","editor");j.themeblvd("options","code-editor");j.themeblvd("options","column-widths");j.themeblvd("options","sortable");j.find(".sortable:not(:has(div))").addClass("empty");j.find(".sortable:has(div)").removeClass("empty");g.sort_setup();j.find(".element-columns, .element-jumbotron_slider").each(function(){g.columns(b(this).closest(".widget"))});if(!b.trim(j.find("#builder").html())){j.closest("#builder_blvd").find("#tb-clear-layout").hide()}else{j.closest("#builder_blvd").find("#tb-clear-layout").show()}if(b.isFunction(b.fn.ThemeBlvdModal)){j.find(".edit-section-display, .edit-element-display, .edit-block-display").ThemeBlvdModal({button:themeblvd.apply,build:true,form:true,padding:false,size:"medium",on_load:g.content_block_options_load})}if(b.isFunction(b.fn.ThemeBlvdModal)){j.find(".tb-block-options-link").ThemeBlvdModal({button:themeblvd.apply,build:true,form:true,padding:false,size:"medium",on_load:g.content_block_options_load})}},sort_setup:function(){var l=b("#builder_blvd #tb-edit-layout .sortable"),j,m,k;l.each(function(){var n=b(this);if(n.is(":ui-sortable")){n.sortable("destroy")}});l.sortable({handle:".top-widget-name",connectWith:".sortable",remove:function(n,o){j=b(this).closest(".element-section").attr("id")},receive:function(n,o){h.find(".sortable:not(:has(div))").addClass("empty");h.find(".sortable:has(div)").removeClass("empty");m=b(this).closest(".element-section").attr("id");o.item.find("input, textarea, select, option").each(function(){var q=b(this),p=q.attr("name");if(p){q.attr("name",p.replace(j,m))}});o.item.find(".tb-sortable-option").each(function(){var p=b(this);k=p.data("name");k=k.replace(j,m);p.data("name",k)});k=o.item.data("field-name");k=k.replace(j,m);o.item.data("field-name",k);o.item.themeblvd("options","sortable")},stop:function(n,o){g.nag()}})},sample_preview:function(j){var k=j.closest(".controls");k.find(".sample-layouts div").hide();k.find("#sample-"+j.val()).show()},hide_widget:function(k){var j=b("#"+k);if(j.hasClass("postbox-publish")){return}j.find(".tb-widget-content").hide()},show_widget:function(l){var k=b("#"+l);k.find(".tb-widget-content").show();if(k.hasClass("postbox-custom-styles")){var j=k.find("textarea").data("CodeMirrorInstance");if(j){j.refresh()}}},columns:function(k){var l,j,m;k.find(".column-blocks").sortable({handle:".block-widget-name h3",connectWith:"#"+k.closest(".widget").attr("id")+" .column-blocks",remove:function(n,o){m=b(this).html();if(!m.trim().length){b(this).addClass("mini-empty")}l=b(this).closest(".column").find(".col-num").val()},receive:function(o,p){var n=b(this),q;n.removeClass("mini-empty");j=n.closest(".column").find(".col-num").val();p.item.find("input, textarea, select, option").each(function(){var s=b(this),r=s.attr("name");if(r){s.attr("name",r.replace("col_"+l,"col_"+j))}});p.item.find(".tb-sortable-option").each(function(){var r=b(this);q=r.data("name");q=q.replace("col_"+l,"col_"+j);r.data("name",q)});q=p.item.data("field-name");q=q.replace("col_"+l,"col_"+j);p.item.data("field-name",q);p.item.themeblvd("options","editor");g.nag()},stop:function(){g.nag()}});k.find(".edit-columns-config").off("click.tb-col-config");k.find(".edit-columns-config").on("click.tb-col-config",function(){var n=b(this);if(n.data("showing")){n.closest(".element-options").find(".columns-setup").stop().slideUp(200);n.stop().text(n.data("text-show")).data("showing",0)}else{n.closest(".element-options").find(".columns-setup").stop().slideDown(200);n.stop().text(n.data("text-hide")).data("showing",1)}return false});k.find(".column-blocks").each(function(){var n=b(this).html();if(!n.trim().length){b(this).addClass("mini-empty")}});k.find(".columns-config .add-block").off("click.tb-add-block");k.find(".columns-config .add-block").on("click.tb-add-block",function(){var s=b(this).closest(".column"),o=s.closest(".element-section").attr("id"),n=s.closest(".widget.element-options").attr("id"),t=s.find(".col-num").val(),p=s.find(".block-type").val(),q="";if(!p){tbc_confirm(themeblvd.no_element,{textOk:"Ok"});return false}var r={action:"themeblvd_add_block",data:"section_id="+o+"&element_id="+n+"&block_type="+p+"&col_num="+t};b.post(ajaxurl,r,function(u){u=u.split("[(=>)]");s.find(".column-blocks").append(u[1]).removeClass("mini-empty");q=s.find("#"+u[0]);b("#builder_blvd .add").removeClass("add");q.addClass("add");window.setTimeout(function(){q.removeClass("add")},500);q.themeblvd("options","setup");q.themeblvd("options","media-uploader");q.themeblvd("options","editor");q.themeblvd("options","code-editor");q.themeblvd("options","column-widths");q.themeblvd("options","sortable");if(b.isFunction(b.fn.ThemeBlvdModal)){q.find(".tb-block-options-link").ThemeBlvdModal({button:themeblvd.apply,build:true,form:true,padding:false,size:"medium",on_load:g.content_block_options_load})}if(b.isFunction(b.fn.ThemeBlvdModal)){k.find(".edit-block-display").ThemeBlvdModal({button:themeblvd.apply,build:true,form:true,padding:false,size:"medium",on_load:g.content_block_options_load})}g.nag()});return false});k.find(".column-width-input").off("themeblvd_update_columns");k.find(".column-width-input").on("themeblvd_update_columns",function(){var r=b(this),n=r.closest(".element-options").find(".columns-header"),p=r.val(),o=p.split("-"),o=o.length,q="";if(o==1){q=o+" "+themeblvd.column}else{q=o+" "+themeblvd.columns}n.find(".col-count").text(q);n.find(".col-config").text(p.replace(/-/g," - "));k.find(".columns-config").removeClass("columns-1 columns-2 columns-3 columns-4 columns-5").addClass("columns-"+o);g.nag()})},content_block_options_load:function(m){var j=this;j.$modal_window.themeblvd("options","bind");j.$modal_window.themeblvd("options","setup");j.$modal_window.themeblvd("options","media-uploader");j.$modal_window.themeblvd("options","editor");j.$modal_window.themeblvd("options","code-editor");j.$modal_window.themeblvd("options","column-widths");j.$modal_window.themeblvd("options","sortable");var l=j.$modal_window.find(".element-display-options"),k=l.find("#section-bg_type select").val(),n=l.find("#section-apply_padding input").is(":checked");j.$modal_window.on("change",".tb-query-check .of-input",function(){var p=b(this),o=false;if(p.val()=="paginated"){p.addClass("current");b(".tb-query-check .of-input").each(function(){if(!b(this).hasClass("current")&&b(this).val()=="paginated"){o=true}});if(o){tbc_confirm(themeblvd.primary_query,{textOk:"Ok"})}p.removeClass("current");return false}})}};var i=b("#tb-editor-builder"),c=b("#page_template");c.on("change",function(){if(b(this).val()=="template_builder.php"){i.addClass("template-active")}else{i.removeClass("template-active")}});i.find(".meta-box-nav").themeblvd("options","bind");i.find(".meta-box-nav").themeblvd("options","setup");i.find("#tb-template-sync").on("change",function(){var j=b(this);if(j.val()){i.find("#tb-edit-layout").hide();i.find("#tb-sync-layout").show();i.find("#tb-sync-layout .title").text(j.find('option[value="'+j.val()+'"]').text());i.find(".sync-overlay").fadeIn(100)}else{i.find("#tb-sync-layout").hide();i.find("#tb-edit-layout").show();i.find(".sync-overlay").fadeOut(100)}g.nag()});i.find("#tb-template-unsync").on("click",function(){i.find("#tb-sync-layout").hide();i.find("#tb-edit-layout").show();i.find(".sync-overlay").fadeOut(100);$select=i.find("#tb-template-sync");$select.val("").closest(".tb-fancy-select").find(".textbox").text($select.find('option[value=""]').text());g.nag()});i.on("change","#tb-template-apply",function(){var k=b(this),l=k.val(),j=i.find(".ajax-overlay.full-overlay");tbc_confirm(themeblvd.template_apply,{confirm:true},function(m){if(m){j.fadeIn(100);var n={action:"themeblvd_apply_template",security:i.find('input[name="tb_nonce"]').val(),data:k.closest("form").serialize(),info:l};b.post(ajaxurl,n,function(o){i.find("#tb-edit-layout .ajax-mitt").html(o);g.edit(i.find("#tb-edit-layout"));n={action:"themeblvd_get_meta",security:i.find('input[name="tb_nonce"]').val(),key:"_tb_builder_styles",post_id:i.find('input[name="tb_post_id"]').val()};b.post(ajaxurl,n,function(p){var q=i.find("#tb-custom-styles-textarea");q.val(p);if(q.data("CodeMirrorInstance")){q.data("CodeMirrorInstance").setValue(p)}j.fadeOut(200)})})}});k.val("").closest(".tb-fancy-select").find(".textbox").text(k.find('option[value=""]').text())});i.find("#tb-save-new-template").on("click",function(){var j={confirm:true,input:true,input_desc:themeblvd.template_desc,textOk:themeblvd.template_save,"class":"text-center"};tbc_confirm("<h3>"+themeblvd.template_title+"</h3>",j,function(k){if(k){var m=i.find("#builder").find("input, option, select, textarea").serialize();var l={action:"themeblvd_add_template",security:i.find('input[name="tb_nonce"]').val(),data:"tb_template_name="+encodeURIComponent(k)+"&"+m+"&post_id="+i.find('input[name="tb_post_id"]').val()};i.find(".ajax-overlay.full-overlay").fadeIn(100);b.post(ajaxurl,l,function(o){o=o.split("[(=>)]");tbc_confirm(o[0]);i.find(".ajax-overlay.full-overlay").fadeOut(200);var p=i.find(".select-layout.apply");p.html(o[1]).find(".textbox").text(p.find('option[value=""]').text());var n=i.find(".select-layout.sync");n.html(o[2]).find(".textbox").text(n.find('option[value=""]').text())})}else{if(k===""){tbc_confirm(themeblvd.no_name)}}});return false});i.find(".meta-box-nav").themeblvd("options","code-editor");i.find("#tb-clear-layout").on("click",function(){var l=b(this),j=i.find(".ajax-overlay.full-overlay"),k=i.find('input[name="tb_post_id"]').val();tbc_confirm(themeblvd.clear_layout,{confirm:true},function(m){if(m){j.fadeIn(100);var n={action:"themeblvd_clear_layout",security:i.find('input[name="tb_nonce"]').val(),data:k};b.post(ajaxurl,n,function(o){i.find("#tb-edit-layout .ajax-mitt").html(o);i.find("#tb-custom-styles-textarea").val("");g.edit(i.find("#tb-edit-layout"));j.fadeOut(200)})}});return false});b("#manage_layouts").find("form").on("submit.check",function(m){m.preventDefault();var k=b(this),l=k.find('select[name="action"]').val(),j=false;if(l!="trash"){return false}k.find('input[name="posts[]"]').each(function(){if(b(this).is(":checked")){j=true}});if(j){tbc_confirm(themeblvd.delete_layout,{confirm:true},function(n){if(n){k.off("submit.check").submit()}})}else{tbc_confirm(themeblvd.no_layouts)}});var d=b("#add_layout");d.themeblvd("init");d.themeblvd("options","setup");d.themeblvd("options","bind");d.find(".builder-samples #sample, .builder_samples #sample").each(function(){g.sample_preview(b(this))});d.find(".builder-samples #sample, .builder_samples #sample").on("change",function(){g.sample_preview(b(this))});d.find("form").submit(function(j){if(!b(this).find("#section-name .of-input").val()){tbc_confirm(themeblvd.no_name,{textOk:"Ok"});j.preventDefault();return false}});d.find(".builder_samples").hide();d.find(".trigger select").on("change",function(){if(b(this).val()=="sample"){d.find(".builder_samples").show()}else{d.find(".builder_samples").hide()}});var a=b("#builder_blvd.primary");a.find(".fade").delay(3000).animate({height:0,opacity:0},500,function(){b(this).remove()});a.on("click",".delete-layout",function(){var j=this.href;tbc_confirm(themeblvd.delete_layout,{confirm:true},function(k){if(k){location.href=j}});return false});a.each(function(){postboxes.add_postbox_toggles("nav-menus",{pbshow:g.show_widget,pbhide:g.hide_widget})});a.find(".ajax-save-template").on("click",function(){var j=b(this).closest("form"),k=a.find("#publishing-action .ajax-loading"),l=j.find('input[name="tb_nonce"]').val(),m=j.serialize();b.ajax({type:"POST",url:ajaxurl,data:{action:"themeblvd_save_template",security:l,data:m},beforeSend:function(){k.fadeIn(200)},success:function(n){b("body").animate({scrollTop:0},50,function(){a.find(".nav-tab-wrapper").after('<div class="themeblvd-updated updated fade" style="display:none;"><p><strong>'+themeblvd.template_updated+"</strong></p></div>");a.find(".themeblvd-updated").fadeIn(500).delay(3000).fadeOut(500,function(){b(this).remove()});f=false;b("#tb-builder-notice").fadeOut(500,function(){b(this).remove()})});k.fadeOut(200)}});return false});a.on("change","#tb-template-apply",function(){var k=b(this),l=k.val(),j=a.find(".ajax-overlay.full-overlay");tbc_confirm(themeblvd.template_apply,{confirm:true},function(m){if(m){j.fadeIn(100);var n={action:"themeblvd_apply_template",security:a.find('input[name="tb_nonce"]').val(),data:k.closest("form").serialize(),info:l};b.post(ajaxurl,n,function(o){a.find("#tb-edit-layout .ajax-mitt").html(o);g.edit(a.find("#tb-edit-layout"));n={action:"themeblvd_get_meta",security:a.find('input[name="tb_nonce"]').val(),key:"_tb_builder_styles",post_id:a.find('input[name="template_id"]').val()};b.post(ajaxurl,n,function(p){var q=a.find("#custom-styles textarea");q.val(p);if(q.data("CodeMirrorInstance")){q.data("CodeMirrorInstance").setValue(p)}j.fadeOut(200)})})}});k.val("").closest(".tb-fancy-select").find(".textbox").text(k.find('option[value=""]').text())});var e=b("#builder_blvd"),h=e.find("#tb-edit-layout");b("#wpbody-content").on("click","#tb-builder-notice .notice-dismiss",function(){b(this).closest("#tb-builder-notice").fadeOut(300,function(){b(this).remove()});return false});e.on("change",":input",function(){if(e.hasClass("manage")||e.hasClass("add")){return}if(b(this).hasClass("tb-select-element")||b(this).hasClass("block-type")){return}g.nag()});e.on("mousedown",".jquery-ui-slider-wrap",function(){g.nag()});e.on("themeblvd-color-change",".wp-picker-input-wrap > input",function(){g.nag()});b("body").on("themeblvd-modal-close themeblvd-modal-insert",".themeblvd-modal .button, .themeblvd-modal .button-link",function(){g.nag()});e.on("sortstop",".tb-sortable-option .item-container",function(){g.nag()});e.on("mouseup",".tb-sortable-option .add-item, .tb-sortable-option .delete-sortable-items",function(){g.nag()});h.themeblvd("init");h.themeblvd("options","bind");g.edit(h);h.on("click",".dynamic-label .label-text",function(){var j=b(this),k=j.closest(".dynamic-label").find(".label-input");j.css("opacity","0");k.show().focus();k.on("keydown.edit-label, focusout.edit-label",function(l){if((l.type=="keydown"&&l.keyCode==13)||l.type=="focusout"){if(!k.val()){k.val("...")}j.css("opacity","1").text(k.val());k.hide();k.off("keydown.edit-label, focusout.edit-label").trigger("blur");l.preventDefault();return false}})});h.on("click",".tb-add-new-section",function(){var m=b(this),j=m.parent().find(".ajax-overlay"),k=m.parent().find(".ajax-loading"),l;b.ajax({type:"POST",url:ajaxurl,data:{action:"themeblvd_add_section",data:""},beforeSend:function(){j.show();k.fadeIn("fast")},success:function(o){var n=o.split('<div id="');trim_back=n[1].split('" class="element-section"');section_id=trim_back[0];h.find("#builder").append(o);h.closest("#builder_blvd").find("#tb-clear-layout").fadeIn("fast");h.find(".manage-elements .ajax-overlay").fadeOut("fast");h.find(".tb-no-sections").hide();k.fadeOut("fast");j.fadeOut("fast");l=h.find("#"+section_id);g.sort_setup();l.find(".sortable").addClass("empty");if(b.isFunction(b.fn.ThemeBlvdModal)){l.find(".edit-section-display").ThemeBlvdModal({button:themeblvd.apply,build:true,form:true,padding:false,size:"medium",on_load:g.content_block_options_load})}g.nag()}});return false});h.on("click",".delete-section",function(){var j=b(this);tbc_confirm(j.data("confirm"),{confirm:true},function(k){if(k){j.closest(".element-section").animate({height:0,opacity:0},500,function(){b(this).remove();if(!b.trim(h.find("#builder").html())){h.closest("#builder_blvd").find("#tb-clear-layout").fadeOut("fast");h.find(".manage-elements .ajax-overlay").fadeIn("fast");h.find(".tb-no-sections").slideDown()}g.nag()})}});return false});h.on("click",".shift-section-up, .shift-section-down",function(){var l=b(this),m="down",k=l.closest(".element-section"),j;if(l.hasClass("shift-section-up")){m="up"}if(m=="up"){j=k.prev(".element-section");if(k.is(".element-section:first-child")){tbc_confirm(themeblvd.shift_up_error,{textOk:"Ok"})}else{k.slideUp(200,function(){j.before(k);k.slideDown(200)})}}else{j=k.next(".element-section");if(k.is(".element-section:last-child")){tbc_confirm(themeblvd.shift_down_error,{textOk:"Ok"})}else{k.slideUp(200,function(){j.after(k);k.slideDown(200)})}}k.addClass("add");window.setTimeout(function(){k.removeClass("add")},500);g.nag();return false});h.on("click","#add_new_element",function(){var o=b(this),p,l,k,j,m=o.parent().find(".ajax-overlay.add-element"),n=o.parent().find(".ajax-loading");type=o.parent().find("select").val(),section=h.find(".element-section:first-child").attr("id"),$element="";if(!type){tbc_confirm(themeblvd.no_element,{textOk:"Ok"});return false}b.ajax({type:"POST",url:ajaxurl,data:{action:"themeblvd_add_element",data:"section_id="+section+"&element_type="+type},beforeSend:function(){m.show();n.fadeIn("fast")},success:function(q){l=q.split('<div id="');k=l[1].split('" class="widget element-options"');j=k[0];h.find(".element-section:first-child .elements").append(q).removeClass("empty");$element=b("#"+j);b("#builder_blvd .add").removeClass("add");$element.addClass("add");window.setTimeout(function(){$element.removeClass("add")},500);$element.themeblvd("options","setup");$element.themeblvd("options","media-uploader");$element.themeblvd("options","editor");$element.themeblvd("options","code-editor");$element.themeblvd("options","column-widths");$element.themeblvd("options","sortable");if($element.find(".widget-content").hasClass("element-columns")||$element.find(".widget-content").hasClass("element-jumbotron_slider")){g.columns($element)}$element.fadeIn();n.fadeOut("fast");m.fadeOut("fast");if(b.isFunction(b.fn.ThemeBlvdModal)){$element.find(".edit-element-display").ThemeBlvdModal({button:themeblvd.apply,build:true,form:true,padding:false,size:"medium",on_load:g.content_block_options_load})}g.nag()}});return false});h.on("click",".element-options-nav a",function(){var k=b(this),l=k.data("target"),j=k.closest(".widget");k.closest("ul").find("li").removeClass("active");k.closest("li").addClass("active");if(l=="display"){j.find(".element-display-options-wrap").removeClass("hide");j.find(".element-options-wrap").addClass("hide")}else{j.find(".element-options-wrap").removeClass("hide");j.find(".element-display-options-wrap").addClass("hide")}return false});h.on("click",".duplicate-element",function(){var l=b(this),k=l.closest(".widget"),m=k.find("input, option, select, textarea").serialize(),j;b.ajax({type:"POST",url:ajaxurl,data:{action:"themeblvd_dup_element",data:m},success:function(n){n=n.split("[(=>)]");k.after(n[1]);j=b("#"+n[0]);j.addClass("add");window.setTimeout(function(){j.removeClass("add")},500);j.themeblvd("options","setup");j.themeblvd("options","media-uploader");j.themeblvd("options","editor");j.themeblvd("options","code-editor");j.themeblvd("options","column-widths");j.themeblvd("options","sortable");if(j.find(".widget-content").hasClass("element-columns")||j.find(".widget-content").hasClass("element-jumbotron_slider")){g.columns(j)}if(b.isFunction(b.fn.ThemeBlvdModal)){j.find(".tb-block-options-link").ThemeBlvdModal({button:themeblvd.apply,build:true,form:true,padding:false,size:"medium",on_load:g.content_block_options_load})}if(b.isFunction(b.fn.ThemeBlvdModal)){j.find(".edit-element-display, .edit-block-display").ThemeBlvdModal({button:themeblvd.apply,build:true,form:true,padding:false,size:"medium",on_load:g.content_block_options_load})}g.nag()}});return false});h.on("click",".duplicate-block",function(){var j=b(this),l=j.closest(".block"),k;b.ajax({type:"POST",url:ajaxurl,data:{action:"themeblvd_dup_block",data:l.find("input, option, select, textarea").serialize()},success:function(m){m=m.split("[(=>)]");l.after(m[3]);k=b("#"+m[1]);k.addClass("add");window.setTimeout(function(){k.removeClass("add")},500);k.themeblvd("options","setup");k.themeblvd("options","media-uploader");k.themeblvd("options","editor");k.themeblvd("options","code-editor");k.themeblvd("options","sortable");k.find(".tb-block-options-link").ThemeBlvdModal({button:themeblvd.apply,build:true,form:true,padding:false,size:"medium",on_load:g.content_block_options_load});if(b.isFunction(b.fn.ThemeBlvdModal)){k.find(".edit-block-display").ThemeBlvdModal({button:themeblvd.apply,build:true,form:true,padding:false,size:"medium",on_load:g.content_block_options_load})}g.nag()}});return false});h.on("click",".delete-element",function(){var j=b(this).closest(".widget"),k=j.closest(".sortable");tbc_confirm(b(this).attr("title"),{confirm:true},function(l){if(l){j.addClass("delete fade-out");window.setTimeout(function(){j.slideUp(200,function(){b(this).remove();if(!k.html().trim().length){k.addClass("empty")}});b(".themeblvd-tooltip").remove()},750);g.nag()}});return false});h.on("click",".delete-block",function(){var j=b(this).closest(".block-widget"),k=j.closest(".column-blocks");tbc_confirm(b(this).attr("title"),{confirm:true},function(l){if(l){j.addClass("delete fade-out");window.setTimeout(function(){j.slideUp(200,function(){b(this).remove();if(!k.html().trim().length){k.addClass("mini-empty")}});b(".themeblvd-tooltip").remove()},750);g.nag()}});return false});h.on("change",".tb-query-check .of-input",function(){var k=b(this),j=false;if(k.val()=="paginated"){k.addClass("current");b(".tb-query-check .of-input").each(function(){if(!b(this).hasClass("current")&&b(this).val()=="paginated"){j=true}});if(j){tbc_confirm(themeblvd.primary_query,{textOk:"Ok"})}k.removeClass("current");return false}})});